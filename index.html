<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Cristmas Lights</title>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ„ Ãrvore de Natal Interativa ğŸ„</h1>
      <div class="tree">
        <div class="star">â˜…</div>
        <div class="tree-line" data-level="0">â–²</div>
        <div class="tree-line">
          <span class="light" data-color="blue" data-level="1">â—</span>â–²<span
            class="light"
            data-color="blue"
            data-level="1"
            >â—</span
          >
        </div>
        <div class="tree-line">
          <span class="light" data-color="yellow" data-level="2">â—</span>â–²â–²<span
            class="light"
            data-color="green"
            data-level="2"
            >â—</span
          >
        </div>
        <div class="tree-line">
          <span class="light" data-color="purple" data-level="3">â—</span
          >â–²â–²â–²<span class="light" data-color="white" data-level="3">â—</span>
        </div>
        <div class="tree-line">
          <span class="light" data-color="blue" data-level="4">â—</span>â–²â–²â–²â–²<span
            class="light"
            data-color="red"
            data-level="4"
            >â—</span
          >
        </div>
        <div class="tree-line">
          <span class="light" data-color="green" data-level="5">â—</span
          >â–²â–²â–²â–²â–²<span class="light" data-color="yellow" data-level="5">â—</span>
        </div>
        <div class="tree-line">
          <span class="light" data-color="white" data-level="5">â—</span
          >â–²â–²â–²â–²â–²â–²<span class="light" data-color="purple" data-level="6">â—</span>
        </div>
        <div class="trunk">|||</div>
      </div>
    </div>
    <div class="controls">
      <button onclick="toggleLightsOn()" id="btnToggle">
        Ligar/Desligar Luzes
      </button>
      <button onclick="changePattern('blink')" id="btnBlink" class="frozen">
        Pisca-Pisca
      </button>
      <button onclick="changePattern('cascade')" id="btnCascade" class="frozen">
        Cascata
      </button>
      <button onclick="changePattern('random')" id="btnRandom" class="frozen">
        AleatÃ³rio
      </button>
      <button onclick="toggleSnow()" id="btnSnow" class="frozen">Neve â„</button>
    </div>
  </body>
  <script>
    const lights = document.querySelectorAll(".light");
    let intervals = [];
    let lightOn = false;
    let snowInterval = null;
    let currentPattern = "";
    // FunÃ§Ã£o para ligar/desligar todas as luzes
    function toggleLightsOn() {
      lightOn = !lightOn;
      lights.forEach((light) => {
        if (lightOn) {
          light.classList.remove("off");
          light.classList.add(light.dataset.color);
        } else {
          light.classList.add("off");
          clearIntervals();
        }
      });
      const frozenButtons = ["btnBlink", "btnCascade", "btnRandom", "btnSnow"];
      frozenButtons.forEach((btnId) => {
        const btn = document.getElementById(btnId);
        if (lightOn) {
          // Efeito de quebrar o gelo
          btn.classList.add("ice-crack");
          setTimeout(() => {
            btn.classList.remove("frozen", "ice-crack");
          }, 500);
        } else {
          btn.classList.add("frozen");
        }
      });
      // Se ligou, reinicia o padrÃ£o atual
      if (lightOn) {
        setTimeout(() => {
          if (currentPattern === "blink") blinkPattern();
          else if (currentPattern === "cascade") cascadePattern();
          else if (currentPattern === "random") randomPattern();
        }, 600);
      }
    }

    // Descongelar ou congelar botÃµes
    // Limpar intervalos anteriores necessÃ¡rio para todos os tipos de pisca
    function clearIntervals() {
      intervals.forEach((interval) => clearInterval(interval));
      intervals = [];
    }

    function blinkPattern() {
      clearIntervals();
      //no entervalo de tempo apaga-se a luz
      const interval = setInterval(() => {
        lights.forEach((light) => {
          light.classList.toggle("off");
        });
      }, 500);
      intervals.push(interval);
    }

    // PadrÃ£o: Cascata
    function cascadePattern() {
      clearIntervals();

      // Agrupa luzes por nÃ­vel
      const levels = {};
      lights.forEach((light) => {
        const level = light.dataset.level;
        if (!levels[level]) levels[level] = [];
        levels[level].push(light);
      });

      // Pisca cada nÃ­vel com delay
      Object.keys(levels).forEach((level, index) => {
        setTimeout(() => {
          const interval = setInterval(() => {
            levels[level].forEach((light) => {
              light.classList.toggle("off");
            });
          }, 1000);
          intervals.push(interval);
        }, index * 300);
      });
    }
    // PadrÃ£o: AleatÃ³rio
    function randomPattern() {
      clearIntervals();
      lights.forEach((light) => {
        const interval = setInterval(() => {
          light.classList.toggle("off");
        }, Math.random() * 800 + 400);
        intervals.push(interval);
      });
    }
    // Mudar padrÃ£o
    function changePattern(pattern) {
      if (!lightOn) {
        clearActiveButtons();
        return;
      }
      lightsOn = true;

      lights.forEach((light) => light.classList.remove("off"));
      if (lightsOn) {
        if (pattern === "blink") {
          document.getElementById("btnBlink").classList.add("active");
          blinkPattern();
        } else if (pattern === "cascade") {
          document.getElementById("btnBlink").classList.add("active");
          cascadePattern();
        } else if (pattern === "random") {
          randomPattern();
        }
      } else {
        clearIntervals();
      }
    }
    // Criar flocos de neve
    function createSnowflake() {
      const snowflake = document.createElement("div");
      snowflake.classList.add("snowflake");
      snowflake.textContent = "â„";
      snowflake.style.left = Math.random() * 100 + "vw";
      snowflake.style.animationDuration = Math.random() * 3 + 2 + "s";
      snowflake.style.fontSize = Math.random() * 10 + 15 + "px";
      document.body.appendChild(snowflake);

      setTimeout(() => {
        snowflake.remove();
      }, 5000);
    }

    // Toggle neve
    function toggleSnow() {
      if (snowInterval) {
        clearInterval(snowInterval);
        snowInterval = null;
      } else {
        snowInterval = setInterval(createSnowflake, 200);
      }
    }
  </script>
</html>
