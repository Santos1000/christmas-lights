<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Cristmas Lights</title>
  </head>
  <body>
    <div class="container">
      <h1>üéÑ Interactive Christmas Tree üéÑ</h1>
      <div class="tree">
        <div class="star">‚≠ê</div>
        <div class="tree-line" data-level="0">‚ñ≤</div>
        <div class="tree-line">
          <span class="light" data-color="blue" data-level="1">‚óè</span>‚ñ≤<span
            class="light"
            data-color="blue"
            data-level="1"
            >‚óè</span
          >
        </div>
        <div class="tree-line">
          <span class="light" data-color="yellow" data-level="2">‚óè</span>‚ñ≤‚ñ≤<span
            class="light"
            data-color="green"
            data-level="2"
            >‚óè</span
          >
        </div>
        <div class="tree-line">
          <span class="light" data-color="purple" data-level="3">‚óè</span
          >‚ñ≤‚ñ≤‚ñ≤<span class="light" data-color="white" data-level="3">‚óè</span>
        </div>
        <div class="tree-line">
          <span class="light" data-color="blue" data-level="4">‚óè</span>‚ñ≤‚ñ≤‚ñ≤‚ñ≤<span
            class="light"
            data-color="red"
            data-level="4"
            >‚óè</span
          >
        </div>
        <div class="tree-line">
          <span class="light" data-color="green" data-level="5">‚óè</span
          >‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤<span class="light" data-color="yellow" data-level="5">‚óè</span>
        </div>
        <div class="tree-line">
          <span class="light" data-color="white" data-level="5">‚óè</span
          >‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤<span class="light" data-color="purple" data-level="6">‚óè</span>
        </div>
        <div class="trunk">|||</div>
      </div>
    </div>

    <div class="controls" aria-label="Controles das luzes de Natal">
      <button onclick="toggleLightsOn()" id="btnToggle">
        Turn Lights On/Off
      </button>
      <button onclick="changePattern('blink')" id="btnBlink" class="frozen">
        Blinking Lights
      </button>
      <button onclick="changePattern('cascade')" id="btnCascade" class="frozen">
        Cascade Effect
      </button>
      <button onclick="changePattern('random')" id="btnRandom" class="frozen">
        Random Pattern
      </button>
      <button onclick="toggleSnow()" id="btnSnow" class="frozen">Neve ‚ùÑ</button>
    </div>
    <div class="message">
      Merry Christmas and Happy New Year ! Developed by
      <a
        href="https://linkedin.com/in/santBarbara"
        target="Meu link para o Linkedin"
        >Barbara Santos</a
      >
    </div>
  </body>
  <script>
    const lights = document.querySelectorAll(".light");
    let intervals = [];
    let lightOn = false;
    let snowInterval = null;
    let currentPattern = "";
    // Fun√ß√£o para ligar/desligar todas as luzes
    function toggleLightsOn() {
      lightOn = !lightOn;
      lights.forEach((light) => {
        if (lightOn) {
          light.classList.remove("off");
          light.classList.add(light.dataset.color);
        } else {
          toggleSnow(true); // For√ßar a desligar a neve
          light.classList.add("off");
          clearIntervals();
        }
      });
      const frozenButtons = ["btnBlink", "btnCascade", "btnRandom", "btnSnow"];
      frozenButtons.forEach((btnId) => {
        const btn = document.getElementById(btnId);
        if (lightOn) {
          // Efeito de quebrar o gelo
          btn.classList.add("ice-crack");
          setTimeout(() => {
            btn.classList.remove("frozen", "ice-crack");
          }, 500);
        } else {
          btn.classList.add("frozen");
        }
      });
      // Se ligou, reinicia o padr√£o atual
      if (lightOn) {
        setTimeout(() => {
          if (currentPattern === "blink") blinkPattern();
          else if (currentPattern === "cascade") cascadePattern();
          else if (currentPattern === "random") randomPattern();
        }, 600);
      }
    }

    // Descongelar ou congelar bot√µes
    // Limpar intervalos anteriores necess√°rio para todos os tipos de pisca
    function clearIntervals() {
      intervals.forEach((interval) => clearInterval(interval));
      intervals = [];
    }

    function blinkPattern() {
      clearIntervals();
      //no entervalo de tempo apaga-se a luz
      const interval = setInterval(() => {
        lights.forEach((light) => {
          light.classList.toggle("off");
        });
      }, 500);
      intervals.push(interval);
    }

    // Padr√£o: Cascata
    function cascadePattern() {
      clearIntervals();

      // Agrupa luzes por n√≠vel
      const levels = {};
      lights.forEach((light) => {
        const level = light.dataset.level;
        if (!levels[level]) levels[level] = [];
        levels[level].push(light);
      });

      // Pisca cada n√≠vel com delay
      Object.keys(levels).forEach((level, index) => {
        setTimeout(() => {
          const interval = setInterval(() => {
            levels[level].forEach((light) => {
              light.classList.toggle("off");
            });
          }, 1000);
          intervals.push(interval);
        }, index * 300);
      });
    }
    // Padr√£o: Aleat√≥rio
    function randomPattern() {
      clearIntervals();
      lights.forEach((light) => {
        const interval = setInterval(() => {
          light.classList.toggle("off");
        }, Math.random() * 800 + 400);
        intervals.push(interval);
      });
    }
    // Mudar padr√£o
    function changePattern(pattern) {
      if (!lightOn) {
        clearActiveButtons();
        return;
      }
      lightsOn = true;

      lights.forEach((light) => light.classList.remove("off"));
      if (lightsOn) {
        if (pattern === "blink") {
          document.getElementById("btnBlink").classList.add("active");
          blinkPattern();
        } else if (pattern === "cascade") {
          document.getElementById("btnBlink").classList.add("active");
          cascadePattern();
        } else if (pattern === "random") {
          randomPattern();
        }
      } else {
        clearIntervals();
      }
    }
    // Criar flocos de neve
    function createSnowflake() {
      const snowflake = document.createElement("div");
      snowflake.classList.add("snowflake");
      snowflake.textContent = "‚ùÑ";
      snowflake.style.left = Math.random() * 100 + "vw";
      snowflake.style.animationDuration = Math.random() * 3 + 2 + "s";
      snowflake.style.fontSize = Math.random() * 10 + 15 + "px";
      document.body.appendChild(snowflake);

      setTimeout(() => {
        snowflake.remove();
      }, 5000);
    }

    // Toggle neve
    function toggleSnow(forceOff = false) {
      if (forceOff && snowInterval) {
        // Se forceOff √© true, sempre desliga
        clearInterval(snowInterval);
        snowInterval = null;
        document.getElementById("btnSnow").classList.remove("active");
      } else if (!forceOff) {
        // Comportamento normal de toggle
        if (snowInterval) {
          clearInterval(snowInterval);
          snowInterval = null;
          document.getElementById("btnSnow").classList.remove("active");
        } else {
          snowInterval = setInterval(createSnowflake, 200);
          document.getElementById("btnSnow").classList.add("active");
        }
      }
    }
  </script>
</html>
